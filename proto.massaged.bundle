<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<l7:Bundle xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
            <l7:References>
                <l7:Item>
                    <l7:Name>proto</l7:Name>
                    <l7:Id>6b799f4eefdfb11df8800690f167b2e9</l7:Id>
                    <l7:Type>FOLDER</l7:Type>
                    <l7:TimeStamp>2018-11-09T20:58:31.859Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Folder folderId="0000000000000000ffffffffffffec76" id="6b799f4eefdfb11df8800690f167b2e9" version="0">
                            <l7:Name>proto</l7:Name>
                        </l7:Folder>
                    </l7:Resource>
                </l7:Item>
                <l7:Item>
                    <l7:Name>/api/*</l7:Name>
                    <l7:Id>6b799f4eefdfb11df8800690f167b593</l7:Id>
                    <l7:Type>SERVICE</l7:Type>
                    <l7:TimeStamp>2018-11-09T20:58:31.969Z</l7:TimeStamp>
                    <l7:Resource>
                        <l7:Service id="6b799f4eefdfb11df8800690f167b593" version="2">
                            <l7:ServiceDetail folderId="6b799f4eefdfb11df8800690f167b2e9" id="6b799f4eefdfb11df8800690f167b593" version="2">
<l7:Name>/api/*</l7:Name>
<l7:Enabled>true</l7:Enabled>
<l7:ServiceMappings>
    <l7:HttpMapping>
        <l7:UrlPattern>/api/*</l7:UrlPattern>
        <l7:Verbs>
            <l7:Verb>GET</l7:Verb>
            <l7:Verb>POST</l7:Verb>
            <l7:Verb>PUT</l7:Verb>
            <l7:Verb>DELETE</l7:Verb>
        </l7:Verbs>
    </l7:HttpMapping>
</l7:ServiceMappings>
<l7:Properties>
    <l7:Property key="internal">
        <l7:BooleanValue>false</l7:BooleanValue>
    </l7:Property>
    <l7:Property key="policyRevision">
        <l7:LongValue>15</l7:LongValue>
    </l7:Property>
    <l7:Property key="soap">
        <l7:BooleanValue>false</l7:BooleanValue>
    </l7:Property>
    <l7:Property key="tracingEnabled">
        <l7:BooleanValue>false</l7:BooleanValue>
    </l7:Property>
    <l7:Property key="wssProcessingEnabled">
        <l7:BooleanValue>false</l7:BooleanValue>
    </l7:Property>
</l7:Properties>
                            </l7:ServiceDetail>
                            <l7:Resources>
<l7:ResourceSet tag="policy">
    <l7:Resource type="policy" version="14">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wsp:Policy xmlns:L7p=&quot;http://www.layer7tech.com/ws/policy&quot; xmlns:wsp=&quot;http://schemas.xmlsoap.org/ws/2002/12/policy&quot;&gt;
    &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
        &lt;L7p:FaultLevel&gt;
            &lt;L7p:LevelInfo soapFaultLevel=&quot;included&quot;&gt;
                &lt;L7p:Level intValue=&quot;4&quot;/&gt;
            &lt;/L7p:LevelInfo&gt;
        &lt;/L7p:FaultLevel&gt;
        &lt;wsp:OneOrMore wsp:Usage=&quot;Required&quot;&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:CaptureVar stringValue=&quot;downstream-path-pieces&quot;/&gt;
                    &lt;L7p:IncludeEntireExpressionCapture booleanValue=&quot;false&quot;/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue=&quot;request.url.path&quot;/&gt;
                    &lt;L7p:Regex stringValue=&quot;^/api/([^/]+)/(v[^/]+)/(.*)$&quot;/&gt;
                    &lt;L7p:RegexName stringValue=&quot;fetch downstream path pieces&quot;/&gt;
                    &lt;L7p:Replacement stringValue=&quot;&quot;/&gt;
                    &lt;L7p:Target target=&quot;OTHER&quot;/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;YXBpLSR7ZG93bnN0cmVhbS1wYXRoLXBpZWNlc1swXX0tJHtkb3duc3RyZWFtLXBhdGgtcGllY2VzWzFdfS5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2Fs&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;downstream-host&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:Base64Expression stringValue=&quot;JHtkb3duc3RyZWFtLXBhdGgtcGllY2VzWzJdfQ==&quot;/&gt;
                    &lt;L7p:VariableToSet stringValue=&quot;downstream-path&quot;/&gt;
                &lt;/L7p:SetVariable&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage=&quot;Required&quot;&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue=&quot;Failed to parse request path: ${request.url.path}. Expected format of: /api/air-operations/v1/air-operations/api/air/flights/status&quot;/&gt;
                    &lt;L7p:Level stringValue=&quot;WARNING&quot;/&gt;
                    &lt;L7p:LoggingOnly booleanValue=&quot;true&quot;/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
                &lt;L7p:FalseAssertion/&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
        &lt;L7p:AuditDetailAssertion&gt;
            &lt;L7p:Detail stringValue=&quot;About to route to ${downstream-host}/${downstream-path}${request.url.query}&quot;/&gt;
            &lt;L7p:LoggingOnly booleanValue=&quot;true&quot;/&gt;
        &lt;/L7p:AuditDetailAssertion&gt;
        &lt;L7p:HardcodedResponse&gt;
            &lt;L7p:Base64ResponseBody stringValue=&quot;VnJhY2lhbSByZXF1ZXN0LnVybDogJHtyZXF1ZXN0LnVybH0sIHJlcXVlc3QudXJsLnBhdGg6ICR7cmVxdWVzdC51cmwucGF0aH0sIHJlcXVlc3QudXJsLnF1ZXJ5OiAke3JlcXVlc3QudXJsLnF1ZXJ5fSwgcmVxdWVzdC5odHRwLnVyaTogJHtyZXF1ZXN0Lmh0dHAudXJpfSwgcmVxdWVzdC51cmwuZnJhZ21lbnQ6ICR7cmVxdWVzdC51cmwuZnJhZ21lbnR9CmRvd25zdHJlYW0tcGF0aC1waWVjZXM6ICR7ZG93bnN0cmVhbS1wYXRoLXBpZWNlc30KSG93Z2gK&quot;/&gt;
            &lt;L7p:Enabled booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:ResponseContentType stringValue=&quot;text/plain; charset=UTF-8&quot;/&gt;
        &lt;/L7p:HardcodedResponse&gt;
        &lt;L7p:HttpRoutingAssertion&gt;
            &lt;L7p:FailOnErrorStatus booleanValue=&quot;false&quot;/&gt;
            &lt;L7p:ProtectedServiceUrl stringValue=&quot;http://${downstream-host}/${downstream-path}${request.url.query}&quot;/&gt;
            &lt;L7p:ProxyPassword stringValueNull=&quot;null&quot;/&gt;
            &lt;L7p:ProxyUsername stringValueNull=&quot;null&quot;/&gt;
            &lt;L7p:RequestHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                    &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                        &lt;L7p:Name stringValue=&quot;Cookie&quot;/&gt;
                    &lt;/L7p:item&gt;
                    &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                        &lt;L7p:Name stringValue=&quot;SOAPAction&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Rules&gt;
            &lt;/L7p:RequestHeaderRules&gt;
            &lt;L7p:RequestParamRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;/&gt;
            &lt;/L7p:RequestParamRules&gt;
            &lt;L7p:ResponseHeaderRules httpPassthroughRuleSet=&quot;included&quot;&gt;
                &lt;L7p:ForwardAll booleanValue=&quot;true&quot;/&gt;
                &lt;L7p:Rules httpPassthroughRules=&quot;included&quot;&gt;
                    &lt;L7p:item httpPassthroughRule=&quot;included&quot;&gt;
                        &lt;L7p:Name stringValue=&quot;Set-Cookie&quot;/&gt;
                    &lt;/L7p:item&gt;
                &lt;/L7p:Rules&gt;
            &lt;/L7p:ResponseHeaderRules&gt;
            &lt;L7p:SamlAssertionVersion intValue=&quot;2&quot;/&gt;
        &lt;/L7p:HttpRoutingAssertion&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
</l7:ResourceSet>
                            </l7:Resources>
                        </l7:Service>
                    </l7:Resource>
                </l7:Item>
            </l7:References>
            <l7:Mappings>
                <l7:Mapping action="NewOrExisting" srcId="0000000000000000ffffffffffffec76" srcUri="https://4b344a9cbf4f:18443/restman/1.0/folders/0000000000000000ffffffffffffec76" type="FOLDER">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="6b799f4eefdfb11df8800690f167b2e9" srcUri="https://4b344a9cbf4f:18443/restman/1.0/folders/6b799f4eefdfb11df8800690f167b2e9" type="FOLDER"/>
                <l7:Mapping action="NewOrExisting" srcId="00000000000000000000000000000002:SSL" srcUri="https://4b344a9cbf4f:18443/restman/1.0/privateKeys/00000000000000000000000000000002:SSL" type="SSG_KEY_ENTRY">
                    <l7:Properties>
                        <l7:Property key="FailOnNew">
                            <l7:BooleanValue>true</l7:BooleanValue>
                        </l7:Property>
                    </l7:Properties>
                </l7:Mapping>
                <l7:Mapping action="NewOrExisting" srcId="6b799f4eefdfb11df8800690f167b593" srcUri="https://4b344a9cbf4f:18443/restman/1.0/services/6b799f4eefdfb11df8800690f167b593" type="SERVICE"/>
            </l7:Mappings>
        </l7:Bundle>
